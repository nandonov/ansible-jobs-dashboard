# Ansible Job Dashboard – Vulnerability Assessment (2025-09-26)

## Overview
A comprehensive security sweep was executed on 2025-09-26 through 2025-09-27 covering source code, dependency, and container baselines for both the Python backend and React frontend. The goal was to surface known CVEs and common misconfigurations and to document any tooling gaps encountered during the process.

## Environment
- Host OS: Linux
- Python environment: `/home/andon/repos/.venv` (Python 3.12.3)
- Node.js audit run against existing `node_modules`

## Backend (Python)
- **Static code analysis:** `/home/andon/repos/.venv/bin/bandit -r app` → **No issues**.
- **Type checks:** `/home/andon/repos/.venv/bin/mypy app --ignore-missing-imports` → **Clean**. SQLAlchemy models were upgraded to the typed DeclarativeBase API to satisfy MyPy.
- **Dependency audit:**
	- Initial run of `/home/andon/repos/.venv/bin/pip-audit --local` surfaced **3 vulnerabilities** introduced by security tooling (`checkov` pulled in `asteval 1.0.5` and `urllib3 1.26.20`). Removing Checkov from the shared venv and upgrading to `urllib3 2.5.0` and `asteval 1.0.6` cleared the findings; the latest audit reports **no known vulnerabilities**. Keep scanner dependencies isolated (e.g., Dockerized Checkov) to avoid future noise.
	- Safety CLI requires interactive login (`safety scan`) and could not be automated in this environment.
- **Container hardening:** `backend/Dockerfile` now ships with a non-root user and an HTTP health check.

## Frontend (Node.js)
- **Dependency audit:** `npm audit --json` and `npm audit --production` → **No vulnerabilities**.
- **Static analysis:** `npx eslint src --max-warnings=0` (flat-config with React, a11y, hooks, security rules) → **Pass**. Fixes included accessibility keyboard handlers and safer status aggregation logic.
- **Container hardening:**
	- `frontend/Dockerfile` now switches to the `nginx` user with the CAP_NET_BIND_SERVICE capability and exposes a health check.
	- Multi-stage build remains unchanged otherwise.

## Infrastructure & secrets
- **IaC checks:** `/home/andon/repos/.venv/bin/checkov -d .` → Initially flagged missing health checks and non-root usage; both Dockerfiles were updated and Checkov now reports **0 failures**.
- **Secret scanning:** `/home/andon/repos/.venv/bin/detect-secrets scan --all-files --exclude-files 'node_modules|\.venv|__pycache__|\.mypy_cache'` → **No findings** after excluding vendor caches.

## Outstanding / blocked items
- **Safety CLI:** Requires interactive login; manual run or API token needed for automation.
- **Container image CVE scan:** Tools like Trivy/Grype are unavailable in this environment (`pip install` not provided). Consider running them via Docker or CI.
- **Runtime DAST:** OWASP ZAP/Burp were not executed. Recommend scheduling a scan against a running compose stack.

## Next Steps
- Keep `pip-audit` and `npm audit --production` in CI, isolating optional tooling to prevent noise from scanner dependencies.
- Gate merges on Bandit, MyPy, ESLint, and Checkov to prevent regressions.
- Add automated container image scanning (Trivy or Grype) and a lightweight ZAP baseline scan in CI/CD once the tooling is available.
